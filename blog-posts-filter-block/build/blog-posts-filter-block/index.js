(()=>{"use strict";var e={n:s=>{var a=s&&s.__esModule?()=>s.default:()=>s;return e.d(a,{a}),a},d:(s,a)=>{for(var l in a)e.o(a,l)&&!e.o(s,l)&&Object.defineProperty(s,l,{enumerable:!0,get:a[l]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.wp.blocks,a=JSON.parse('{"UU":"bpffb/blog-posts-filter"}'),l=window.wp.blockEditor,t=window.wp.components,n=window.wp.element,r=window.wp.apiFetch;var i=e.n(r);const c=window.wp.htmlEntities,o=window.ReactJSXRuntime;function d({posts:e=[],gridStyle:s}){const a=(0,n.useMemo)(()=>({display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",gap:"1.5rem"}),[]),l=s||a;return(0,o.jsx)("div",{style:l,children:e.map(e=>{const s=(e=>{const s=e?._embedded?.["wp:featuredmedia"]?.[0];return{url:s?.source_url||"",alt:s?.alt_text||""}})(e),a=(l=e,(l?._embedded?.["wp:term"]?.[0]||[]).map(e=>({id:e.id,name:e.name,link:e.link})));var l;const t=((e="",s=200)=>{const a=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim(),l=a?a.split(" ").length:0;return`${Math.max(1,Math.round(l/s))} min`})(e?.content?.rendered||"");return(0,o.jsxs)("article",{className:"h-100 d-flex flex-column position-relative border-0",children:[s.url&&(0,o.jsx)("img",{className:"mb-3 rounded",src:s.url,alt:s.alt,style:{width:"100%",aspectRatio:"4/3",objectFit:"cover"},loading:"lazy"}),(0,o.jsxs)("div",{className:"d-flex gap-2 align-items-center mb-2 flex-wrap",children:[a.map(e=>(0,o.jsx)("a",{href:e.link,className:"badge bg-primary-subtle border border-primary-subtle text-primary-emphasis text-decoration-none border border-primary",children:(0,c.decodeEntities)(e.name)},e.id)),(0,o.jsxs)("span",{className:"small text-muted",children:[t," read"]})]}),(0,o.jsx)("h3",{className:"h5 mb-2",dangerouslySetInnerHTML:{__html:e.title.rendered}}),(0,o.jsxs)("div",{className:"flex-grow-1 d-flex flex-column justify-content-between",children:[(0,o.jsx)("div",{className:"mb-0 text-muted",dangerouslySetInnerHTML:{__html:e.excerpt.rendered}}),(0,o.jsxs)("a",{className:"stretched-link icon-link",href:e.link,children:["Read more",(0,o.jsx)("svg",{className:"icon",children:(0,o.jsx)("use",{href:"/wp-content/themes/kp-theme/assets/fonts/icon.svg#chevron-right"})})]})]})]},e.id)})})}function m({page:e,totalPages:s,onPrev:a,onNext:l,onGoTo:t}){const r=(0,n.useMemo)(()=>Array.from({length:s},(e,s)=>s+1),[s]);return!s||s<=1?null:(0,o.jsxs)("div",{className:"pagination justify-content-center mt-4 d-flex gap-2 align-items-center",children:[e>1&&(0,o.jsxs)("a",{className:"prev-next icon-link",onClick:a,children:["Previous",(0,o.jsx)("svg",{className:"icon",children:(0,o.jsx)("use",{href:"/wp-content/themes/kp-theme/assets/fonts/icon.svg#chevron-left"})})]}),(0,o.jsx)("div",{className:"d-flex gap-1",children:r.map(s=>(0,o.jsx)("a",{className:"page-numbers "+(s===e?"current":""),onClick:()=>t(s),"aria-current":s===e?"page":void 0,children:s},s))}),e<s&&(0,o.jsxs)("a",{className:"prev-next icon-link",onClick:l,children:["Next",(0,o.jsx)("svg",{className:"icon",children:(0,o.jsx)("use",{href:"/wp-content/themes/kp-theme/assets/fonts/icon.svg#chevron-right"})})]})]})}function p(){const e=(0,n.useMemo)(()=>({display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",gap:"1.5rem"}),[3]);return(0,o.jsx)("div",{style:e,children:Array.from({length:6}).map((e,s)=>(0,o.jsx)("article",{children:(0,o.jsxs)("div",{className:"card h-100 border-0",style:{backgroundColor:"red"},"aria-hidden":"true",children:[(0,o.jsx)("span",{className:"card-img-top placeholder",style:{aspectRatio:"4 / 3",display:"block"}}),(0,o.jsxs)("div",{className:"card-body d-flex flex-column",children:[(0,o.jsx)("h5",{className:"card-title placeholder-glow",children:(0,o.jsx)("span",{className:"placeholder col-7"})}),(0,o.jsxs)("div",{className:"d-flex gap-2 align-items-center mb-3 flex-wrap",children:[(0,o.jsx)("span",{className:"placeholder-glow",children:(0,o.jsx)("span",{className:"placeholder rounded-pill",style:{width:"4.5rem"},children:" "})}),(0,o.jsx)("span",{className:"placeholder-glow",children:(0,o.jsx)("span",{className:"placeholder rounded-pill",style:{width:"4.5rem"},children:" "})}),(0,o.jsx)("span",{className:"ms-auto placeholder-glow",children:(0,o.jsx)("span",{className:"placeholder rounded-pill",style:{width:"3.5rem"},children:" "})})]}),(0,o.jsxs)("p",{className:"card-text placeholder-glow flex-grow-1",children:[(0,o.jsx)("span",{className:"placeholder col-12"}),(0,o.jsx)("span",{className:"placeholder col-12"}),(0,o.jsx)("span",{className:"placeholder col-10"}),(0,o.jsx)("span",{className:"placeholder col-8"})]}),(0,o.jsx)("a",{href:"#",tabIndex:"-1",className:"btn btn-primary disabled placeholder col-6","aria-disabled":"true"})]})]})},s))})}function h({loading:e,cats:s,activeCat:a,onSelect:l,skeletonCount:t=6}){return e?(0,o.jsx)("ul",{className:"nav nav-pills blog-filters mb-3",children:Array.from({length:t}).map((e,s)=>(0,o.jsx)("li",{className:"nav-item",children:(0,o.jsx)("span",{className:"nav-link filter-tab disabled placeholder-glow",children:(0,o.jsx)("span",{className:"placeholder col-8",children:" "})})},s))}):s&&0!==s.length?(0,o.jsxs)("ul",{className:"nav nav-pills blog-filters mb-3",children:[(0,o.jsx)("li",{className:"nav-item",children:(0,o.jsx)("button",{className:"nav-link filter-tab "+(0===a?"active":""),onClick:()=>l(0),type:"button",children:"View all"})}),s.map(e=>(0,o.jsx)("li",{className:"nav-item",children:(0,o.jsx)("button",{className:"nav-link filter-tab "+(a===e.id?"active":""),onClick:()=>l(e.id),type:"button",children:(0,c.decodeEntities)(e.name)})},e.id))]}):null}const x=({perPage:e,page:s,cat:a})=>{const l=new URLSearchParams;return l.set("per_page",String(e)),l.set("page",String(s)),l.set("_embed","1"),l.set("orderby","date"),l.set("order","desc"),a&&Number(a)>0&&l.set("categories",String(a)),`/wp/v2/posts?${l.toString()}`};function g({perPage:e=6,columns:s=3}){const[a,l]=(0,n.useState)([]),[t,r]=(0,n.useState)(0),[c,g]=(0,n.useState)(!0),[u,j]=(0,n.useState)(1),[b,f]=(0,n.useState)([]),[v,N]=(0,n.useState)(1),[w,y]=(0,n.useState)(!0),[k,S]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=!1;return g(!0),i()({path:"/wp/v2/categories?per_page=100&hide_empty=1"}).then(s=>{e||l(Array.isArray(s)?s:[])}).catch(s=>{e||S(s?.message||"Failed to load categories")}).finally(()=>{e||g(!1)}),()=>{e=!0}},[]),(0,n.useEffect)(()=>{let s=!1;return y(!0),S(""),i()({path:x({perPage:e,page:u,cat:t}),parse:!1}).then(async e=>{const a=await e.json(),l=Number(e.headers.get("X-WP-TotalPages")||"1");s||(f(Array.isArray(a)?a:[]),N(l||1))}).catch(e=>{s||S(e?.message||"Failed to load posts")}).finally(()=>{s||y(!1)}),()=>{s=!0}},[e,u,t]);const C=(0,n.useMemo)(()=>({display:"grid",gridTemplateColumns:`repeat(${s}, minmax(0, 1fr))`,gap:"1.5rem"}),[s]),P=c||w;return(0,o.jsxs)("div",{className:"hide-wp-block-classes alignwide mb-3",children:[!c&&a.length>1&&(0,o.jsx)("div",{className:"mb-3",children:(0,o.jsx)(h,{cats:a,activeCat:t,onSelect:e=>{r(e),j(1)}})}),k&&(0,o.jsx)("div",{className:"bpffb-error alert alert-danger",children:k}),P?(0,o.jsx)(p,{}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d,{posts:b,gridStyle:C}),(0,o.jsx)(m,{page:u,totalPages:v,onPrev:()=>j(e=>Math.max(1,e-1)),onNext:()=>j(e=>Math.min(v,e+1)),onGoTo:e=>j(e)})]})]})}(0,s.registerBlockType)(a.UU,{edit:function({attributes:e,setAttributes:s}){const{perPage:a,columns:n}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.InspectorControls,{children:(0,o.jsxs)(t.PanelBody,{title:"Settings",initialOpen:!0,children:[(0,o.jsx)(t.RangeControl,{label:"Posts per page",value:a,min:1,max:24,onChange:e=>s({perPage:e})}),(0,o.jsx)(t.RangeControl,{label:"Columns",value:n,min:1,max:4,onChange:e=>s({columns:e})})]})}),(0,o.jsx)(g,{perPage:a,columns:n})]})},save:()=>null})})();